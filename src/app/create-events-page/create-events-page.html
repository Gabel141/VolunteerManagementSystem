<div class="container py-4">
	<div class="row justify-content-start">
		<div class="col-12 col-lg-8">
			<div class="card shadow-sm">
				<div class="card-body">
					<h3 class="card-title mb-4 text-primary">
						<span *ngIf="!isEditMode()">‚ûï Create New Event</span>
						<span *ngIf="isEditMode()">‚úèÔ∏è Edit Event</span>
					</h3>

					<div *ngIf="errorMessage()" class="alert alert-danger" role="alert">
						{{ errorMessage() }}
					</div>

					<form (ngSubmit)="createEvent()" #eventForm="ngForm" novalidate>
						<div class="mb-3">
							<label for="title" class="form-label">Event Title *</label>
							<input
								id="title"
								type="text"
								class="form-control"
								required
								[value]="eventTitle()"
								(input)="eventTitle.set($any($event.target).value)"
								placeholder="e.g., Community Cleanup, Basketball Tournament"
							>
						</div>

						<div class="mb-3">
							<label for="description" class="form-label">Description *</label>
							<textarea
								id="description"
								class="form-control"
								rows="5"
								required
								[value]="eventDescription()"
								(input)="eventDescription.set($any($event.target).value)"
								placeholder="Describe your event in detail..."
							></textarea>
						</div>

						<div class="row">
							<div class="col-md-6 mb-3">
								<label for="location" class="form-label">Location *</label>
								<input
									id="location"
									type="text"
									class="form-control"
									required
									[value]="eventLocation()"
									(input)="eventLocation.set($any($event.target).value)"
									placeholder="Event location"
								>
							</div>

							<div class="col-md-6 mb-3">
								<label for="workType" class="form-label">Work Type</label>
								<select id="workType" class="form-select" (change)="eventWorkType.set($any($event.target).value)" [value]="eventWorkType()">
									<option value="">Select type (e.g., Cleanup, Tutoring, Food Drive)</option>
									<option value="cleanup">Cleanup</option>
									<option value="mentoring">Mentoring</option>
									<option value="food_drive">Food Drive</option>
									<option value="construction">Construction / Repair</option>
									<option value="other">Other</option>
								</select>
							</div>

							<div class="col-md-6 mb-3">
								<label for="date" class="form-label">Date * <span class="text-muted" style="font-size: 0.875rem;">(cannot be in the past)</span></label>
								<input
									id="date"
									type="date"
									class="form-control"
									[class.is-invalid]="dateError()"
									required
									(input)="eventDate.set($any($event.target).value); validateEventDate()"
									(change)="validateEventDate()"
									[value]="eventDate()"
									[min]="getTodayDate()"
								/>
								<div class="invalid-feedback d-block" *ngIf="dateError()">
									{{ dateError() }}
								</div>
							</div>

							<div class="col-md-6 mb-3">
								<label for="memberCap" class="form-label">Member Cap (Optional)</label>
								<input
									id="memberCap"
									type="number"
									class="form-control"
									min="1"
									(input)="eventMemberCap.set($any($event.target).value)"
									[value]="eventMemberCap()"
									placeholder="Max participants (leave blank for no limit)"
								>
							</div>
						</div>

						<div class="mb-4">
							<label for="time" class="form-label">Time *</label>
							<input
								id="time"
								type="time"
								class="form-control"
								required
								[value]="eventTime()"
								(input)="eventTime.set($any($event.target).value)"
								placeholder="Event time"
							>
						</div>

						<div class="d-flex gap-2">
							<button
								type="button"
								(click)="createEvent()"
								class="btn btn-primary btn-lg"
								[disabled]="isLoading() || dateError() !== ''"
							>
								<span *ngIf="!isLoading() && !isEditMode()">‚úÖ Create Event</span>
								<span *ngIf="!isLoading() && isEditMode()">üíæ Save Changes</span>
								<span *ngIf="isLoading()">
									<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
									<span *ngIf="!isEditMode()">Creating...</span>
									<span *ngIf="isEditMode()">Saving...</span>
								</span>
							</button>
							<a routerLink="/events" class="btn btn-outline-secondary btn-lg">
								Cancel
							</a>
						</div>
					</form>
				</div>
			</div>

			<div class="row">
				<div class="col-6 mb-3">
					<label for="latitude" class="form-label">Latitude</label>
					<input id="latitude" type="text" class="form-control" (input)="eventLatitude.set($any($event.target).value)" [value]="eventLatitude()" placeholder="Optional latitude" />
				</div>
				<div class="col-6 mb-3">
					<label for="longitude" class="form-label">Longitude</label>
					<input id="longitude" type="text" class="form-control" (input)="eventLongitude.set($any($event.target).value)" [value]="eventLongitude()" placeholder="Optional longitude" />
				</div>
			</div>
		</div>
	</div>
</div>
